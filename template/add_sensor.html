{% load compress %} 
{% load static %} 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="icon" type="image/x-icon" href="{% static 'main/iconPL.ico' %}">
    {% include 'navbar.html' %}
</head>
<body>
    <div class="container">
        <div id="step1" class="step">
            <h2>Step 1: Generate API Key</h2>
            <form id="apiKeyForm">
                <label for="apiKey">API Key:</label>
                <input type="text" id="apiKey" name="apiKey" readonly>
                <button type="button" id="copyApiKey">Copy</button>
                <button type="button" id="nextStep1">Next</button>
            </form>
        </div>
    
        <div id="step2" class="step" style="display: none;">
            <h2>Step 2: Sensor Details</h2>
            <form id="sensorDetailsForm">
                <label for="sensorName">Sensor Name:</label>
                <input type="text" id="sensorName" name="sensorName">
                <label for="sensorType">Sensor Type:</label>
                <select id="sensorType" name="sensorType">
                    <option value="temperature">Temperature</option>
                    <option value="humidity">Humidity</option>
                    <option value="pressure">Pressure</option>
                </select>
                <button type="button" id="nextStep2">Next</button>
            </form>
        </div>
    
        <div id="step3" class="step" style="display: none;">
            <h2>Step 3: Confirmation</h2>
            <form id="confirmationForm" readonly>
                <label for="generatedApiKey">Generated API Key:</label>
                <input type="text" id="generatedApiKey" name="generatedApiKey" readonly>
                <label for="sensorNameConfirmation">Sensor Name:</label>
                <input type="text" id="sensorNameConfirmation" name="sensorNameConfirmation" readonly>
                <label for="sensorTypeConfirmation">Sensor Type:</label>
                <input type="text" id="sensorTypeConfirmation" name="sensorTypeConfirmation" readonly>
                <button type="button" id="copyConfirmation">Copy</button>
                <button type="button" id="createSensor">Create Sensor</button>
            </form>
        </div>
    </div>
    
    <script>
        // JavaScript code for handling form steps and API key generation
    
        // Step 1: Generate API Key
        function generateApiKey() {
            // Logic to generate API key (random string or algorithm)
            // For demonstration purposes, I'll use a simple random string
            const apiKey = Math.random().toString(36).substr(2, 10);
            document.getElementById('apiKey').value = apiKey;
        }
    
        document.addEventListener('DOMContentLoaded', function () {
            generateApiKey();
        });
    
        // Step 2: Next button for moving to Step 2
        document.getElementById('nextStep1').addEventListener('click', function () {
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
        });
    
        // Step 3: Next button for moving to Step 3
        document.getElementById('nextStep2').addEventListener('click', function () {
            document.getElementById('step2').style.display = 'none';
            document.getElementById('step3').style.display = 'block';
    
            // Populate Step 3 form with data from Step 1 and Step 2
            const apiKey = document.getElementById('apiKey').value;
            const sensorName = document.getElementById('sensorName').value;
            const sensorType = document.getElementById('sensorType').value;
    
            document.getElementById('generatedApiKey').value = apiKey;
            document.getElementById('sensorNameConfirmation').value = sensorName;
            document.getElementById('sensorTypeConfirmation').value = sensorType;
        });
    
        // Copy button for copying API Key and Confirmation data
        document.getElementById('copyApiKey').addEventListener('click', function () {
            const apiKey = document.getElementById('apiKey');
            apiKey.select();
            document.execCommand('copy');
        });
    
        document.getElementById('copyConfirmation').addEventListener('click', function () {
            const confirmationData = document.getElementById('confirmationForm');
            confirmationData.select();
            document.execCommand('copy');
        });
    
        // Create Sensor button (submit form to Django view for MongoDB insertion)
        document.getElementById('createSensor').addEventListener('click', function () {
            const form = document.getElementById('confirmationForm');
            form.submit(); // Submit the form to your Django view
        });
    </script>

</body>
</html>